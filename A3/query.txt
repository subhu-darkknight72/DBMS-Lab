SELECT `Name` FROM Physician WHERE EmployeeID IN (SELECT Physician FROM Trained_In WHERE Treatment IN (    SELECT Code    FROM `Procedure`    WHERE `Name`='bypass surgery'));
SELECT `Name`  FROM Physician  WHERE EmployeeID IN ( SELECT Physician FROM Trained_In WHERE Treatment IN ( SELECT Code FROM `Procedure` WHERE `Name`='bypass surgery' ) ) AND EmployeeID IN ( SELECT Physician FROM Affiliated_With WHERE Department IN ( SELECT DepartmentID FROM Department Where `Name`='cardiolody' ) );
SELECT Nurse.`Name`  FROM Nurse WHERE EmployeeID IN ( SELECT Nurse  FROM On_Call, Room WHERE On_Call.BlockFloor = Room.BlockFloor AND On_Call.BlockCode = Room.BlockCode AND Room.Number = 123 );
SELECT `Name`,`Address` FROM Patient WHERE SSN IN ( SELECT Patient  FROM Prescribes JOIN Medication ON Prescribes.Medication = Medication.Code WHERE Medication.Name = 'Remdesivir' );
SELECT `Name`, InsuaranceID FROM Patient WHERE SSN IN ( SELECT Patient FROM Stay JOIN Room  ON Stay.Room = Room.Number WHERE Room.`Type`='icu' AND TIMESTAMPDIFF(DAY, Stay.Start, Stay.End)>15 );
SELECT `Name` FROM Nurse WHERE EmployeeID IN ( SELECT Undergoes.AssistingNurse FROM Undergoes JOIN `Procedure` ON Undergoes.`Procedure` = `Procedure`.Code WHERE `Procedure`.`Name`="bypass surgery" );
SELECT Nurse.`Name`, Nurse.Position, Physician.`Name` FROM Nurse, Physician WHERE (Nurse.EmployeeID, Physician.EmployeeID) IN ( SELECT Undergoes.AssistingNurse, Undergoes.Physician FROM Undergoes JOIN `Procedure` ON Undergoes.`Procedure` = `Procedure`.Code WHERE `Procedure`.`Name`="bypass surgery" );
SELECT `Name` as 'Physician Name' FROM Physician WHERE EmployeeID IN ( SELECT Undergoes.Physician FROM Undergoes WHERE (Undergoes.Physician, Undergoes.`Procedure`) NOT IN( SELECT Physician, Treatment FROM Trained_In ) );
SELECT `Name` as 'Physician Name' FROM Physician WHERE EmployeeID IN ( SELECT Undergoes.Physician FROM Undergoes WHERE (Undergoes.Physician, Undergoes.`Procedure`) IN( SELECT Physician, Treatment FROM Trained_In WHERE TIMESTAMPDIFF(SECOND, Trained_In.CertificationExpires, Undergoes.Date)>0 ) );
SELECT  Physician.Name AS 'Physician',  `Procedure`.`Name` AS Treatment,  Undergoes.`Date`,  Patient.Name AS 'Patient' FROM  Physician, `Procedure`, Undergoes, Patient WHERE (Undergoes.Physician, Undergoes.`Procedure`) IN( SELECT Physician, Treatment FROM Trained_In WHERE TIMESTAMPDIFF(SECOND, Trained_In.CertificationExpires, Undergoes.Date)>0 ) AND Physician.EmployeeID=Undergoes.Physician AND `Procedure`.Code=Undergoes.`Procedure` AND Patient.SSN=Undergoes.Patient ;
SELECT Patient.`Name` as 'Patient', Physician.`Name` as 'Physician' FROM Patient JOIN Physician WHERE (Patient.SSN, Physician.EmployeeID) IN ( SELECT Patient, Physician FROM Prescribes WHERE Medication IS NOT NULL ) AND Patient.SSN IN ( SELECT Patient FROM Undergoes JOIN `Procedure` ON Undergoes.`Procedure`=`Procedure`.Code WHERE `Procedure`.Cost>5000  ) AND Patient.SSN IN ( SELECT Patient  FROM ( SELECT Patient, COUNT(*) as cnt FROM ( SELECT Patient FROM Appointment WHERE Physician IN ( SELECT Physician FROM Affiliated_With WHERE Department='cardiology' ) ) AS sq0 GROUP BY Patient ) as SQ1 WHERE cnt>=2 ) AND Physician.EmployeeID IN ( SELECT EmployeeID FROM Physician WHERE EmployeeID NOT IN( SELECT Head FROM Department ) ) ;
SELECT Medication.`Name`, Medication.Brand, COUNT(Prescribes.Patient) AS Qty FROM Medication, Prescribes WHERE Medication.Code = Prescribes.Medication GROUP BY Medication.Code ORDER BY Qty DESC LIMIT 1;
